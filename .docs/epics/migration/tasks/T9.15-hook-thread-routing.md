# T9.15: useThreadRouting Hook

## Metadata

| Field        | Value            |
| ------------ | ---------------- |
| **ID**       | T9.15            |
| **Layer**    | L9 - State Hooks |
| **Status**   | pending          |
| **Priority** | high             |
| **Estimate** | 2h               |
| **Parallel** | true             |
| **Assignee** | -                |
| **Created**  | 2026-01-06       |
| **Updated**  | 2026-01-06       |

## Dependencies

| Task ID | Name    |
| ------- | ------- |
| T7.07   | uiStore |

## Description

Hook for managing thread panel visibility and navigation. Handles opening/closing thread panel and tracking current thread.

## Source Analysis

- **Redux Actions**: `vendor/desktop/webapp/channels/src/actions/views/rhs.ts`

## Migration Target

- **Target File**: `apps/v2/src/hooks/useThreadRouting/useThreadRouting.ts`

## Implementation

```typescript
// apps/v2/src/hooks/useThreadRouting/useThreadRouting.ts

import { useUIStore } from "@/stores";
import { useRouter } from "expo-router";

//#region Types

type IUseThreadRoutingReturn = {
  isThreadOpen: boolean;
  currentThreadId: string | null;
  openThread: (postId: string) => void;
  closeThread: () => void;
};

//#endregion

//#region Hook

export function useThreadRouting(): IUseThreadRoutingReturn {
  const router = useRouter();

  const isThreadOpen = useUIStore((state) => state.isThreadPanelOpen);
  const currentThreadId = useUIStore((state) => state.currentThreadId);
  const setThreadPanel = useUIStore((state) => state.setThreadPanel);

  const openThread = (postId: string) => {
    setThreadPanel(true, postId);
    // On mobile, navigate to thread screen
    // router.push(`/thread/${postId}`);
  };

  const closeThread = () => {
    setThreadPanel(false, null);
  };

  return {
    isThreadOpen,
    currentThreadId,
    openThread,
    closeThread,
  };
}

//#endregion
```

## Acceptance Criteria

- [ ] Returns thread panel open state
- [ ] Returns current thread post ID
- [ ] Provides openThread action
- [ ] Provides closeThread action
- [ ] Works on both mobile (navigation) and desktop (panel)
- [ ] TypeScript strict mode passes
