# T7.03: Query Keys Factory

## Metadata

| Field        | Value                 |
| ------------ | --------------------- |
| **ID**       | T7.03                 |
| **Layer**    | L7 - State Management |
| **Status**   | pending               |
| **Priority** | high                  |
| **Estimate** | 2h                    |
| **Parallel** | false                 |
| **Assignee** | -                     |
| **Created**  | 2026-01-06            |
| **Updated**  | 2026-01-06            |

## Dependencies

| Task ID | Name |
| ------- | ---- |
| -       | -    |

## Blocks

| Task ID | Name                     |
| ------- | ------------------------ |
| T7.10+  | All TanStack Query tasks |
| T7.50   | WebSocket Subscriptions  |

## Description

Create type-safe query key factory for consistent cache key generation across all queries.

**Reference:** See [State Management Architecture](../../../architecture/state-management.md#query-keys-factory) for full implementation.

## Target Files

- `apps/v2/src/queries/keys.ts`

## Key Structure

```typescript
export const queryKeys = {
  posts: {
    all: ["posts"] as const,
    list: (channelId: string, params?: IGetPostsParams) => [...] as const,
    detail: (postId: string) => [...] as const,
    thread: (rootId: string) => [...] as const,
    search: (query: string, params?: ISearchParams) => [...] as const,
  },
  channels: {
    all: ["channels"] as const,
    list: (teamId: string) => [...] as const,
    detail: (channelId: string) => [...] as const,
    members: (channelId: string, params?: IPaginationParams) => [...] as const,
    stats: (channelId: string) => [...] as const,
  },
  users: { ... },
  teams: { ... },
  threads: { ... },
  config: { ... },
  preferences: { ... },
} as const;
```

## Acceptance Criteria

- [ ] Query keys for: posts, channels, users, teams, threads, config, preferences
- [ ] Each domain has: all, list, detail keys
- [ ] Type-safe with `as const` assertions
- [ ] Consistent naming pattern
- [ ] Parameters included in keys for proper cache invalidation
