# T6.16: Text Component

## Metadata

| Field        | Value              |
| ------------ | ------------------ |
| **ID**       | T6.16              |
| **Layer**    | L6 - UI Components |
| **Status**   | pending            |
| **Priority** | high               |
| **Estimate** | 2h                 |
| **Parallel** | true               |
| **Assignee** | -                  |
| **Created**  | 2026-01-06         |
| **Updated**  | 2026-01-06         |

## Dependencies

| Task ID | Name        |
| ------- | ----------- |
| T0.01   | types-theme |

## Blocks

| Task ID | Name                           |
| ------- | ------------------------------ |
| T6.\*   | All text-displaying components |
| T10b.\* | Complex UI with text           |

## Description

Create a foundational Text component that wraps React Native's Text with consistent typography styling via Unistyles. This component enforces design system typography scales and provides semantic variants for different text contexts.

Features:

- Typography variants (heading, body, caption, label)
- Size variants (xs, sm, md, lg, xl, xxl)
- Weight variants (regular, medium, semiBold, bold)
- Color variants (primary, secondary, muted, error, link)
- Truncation with numberOfLines support
- i18n support via translation keys

## Source Files

- `vendor/desktop/webapp/channels/src/sass/components/_typography.scss`
- `vendor/desktop/webapp/channels/src/components/widgets/tag/tag.tsx` (text styles)

### Source Analysis

The original implementation uses:

- **CSS classes**: `.heading`, `.body`, `.caption`, `.label`
- **Size scale**: Based on rem units (12px - 32px range)
- **Font weights**: 400 (regular), 500 (medium), 600 (semiBold), 700 (bold)
- **Theme colors**: Uses CSS variables for text colors

## Migration Target

- **Target File**: `apps/v2/src/components/Text/Text.tsx`
- **Index Export**: `apps/v2/src/components/Text/index.ts`

## Implementation

```typescript
// apps/v2/src/components/Text/Text.tsx

import { Text as RNText, TextProps as RNTextProps } from "react-native";
import { StyleSheet, UnistylesVariants } from "react-native-unistyles";
import { useTranslation } from "react-i18next";

//#region Types

type ITextVariant = "heading" | "body" | "caption" | "label";
type ITextSize = "xs" | "sm" | "md" | "lg" | "xl" | "xxl";
type ITextWeight = "regular" | "medium" | "semiBold" | "bold";
type ITextColor = "primary" | "secondary" | "muted" | "error" | "link" | "inherit";

type IProps = {
  /**
   * Text content (direct)
   */
  children?: React.ReactNode;
  /**
   * i18n translation key
   */
  textKey?: string;
  /**
   * i18n interpolation values
   */
  textParams?: Record<string, string | number>;
  /**
   * Semantic text variant
   * @default "body"
   */
  variant?: ITextVariant;
  /**
   * Text size
   * @default "md"
   */
  size?: ITextSize;
  /**
   * Font weight
   * @default "regular"
   */
  weight?: ITextWeight;
  /**
   * Text color
   * @default "primary"
   */
  color?: ITextColor;
  /**
   * Number of lines before truncation
   */
  numberOfLines?: number;
  /**
   * Text alignment
   * @default "left"
   */
  align?: "left" | "center" | "right";
  /**
   * Ref to underlying RNText
   */
  ref?: React.Ref<React.ComponentRef<typeof RNText>>;
  /**
   * Test ID
   */
  testID?: string;
  /**
   * Accessibility label (overrides children for screen readers)
   */
  accessibilityLabel?: string;
} & UnistylesVariants<typeof styles> &
  Pick<RNTextProps, "selectable" | "ellipsizeMode">;

//#endregion Types

//#region Component

export function Text({
  children,
  textKey,
  textParams,
  variant = "body",
  size = "md",
  weight = "regular",
  color = "primary",
  numberOfLines,
  align = "left",
  selectable = false,
  ellipsizeMode = "tail",
  ref,
  testID,
  accessibilityLabel,
}: IProps) {
  const { t } = useTranslation();

  styles.useVariants({ variant, size, weight, color, align });

  const content = textKey ? t(textKey, textParams) : children;

  return (
    <RNText
      ref={ref}
      style={styles.text}
      numberOfLines={numberOfLines}
      selectable={selectable}
      ellipsizeMode={ellipsizeMode}
      testID={testID}
      accessibilityLabel={accessibilityLabel}
      accessibilityRole="text"
    >
      {content}
    </RNText>
  );
}

//#endregion Component

//#region Styles

const styles = StyleSheet.create((theme) => ({
  text: {
    fontFamily: theme.fonts.primary,
    variants: {
      //#region Variant Styles
      variant: {
        heading: {
          fontFamily: theme.fonts.heading,
        },
        body: {
          fontFamily: theme.fonts.primary,
        },
        caption: {
          fontFamily: theme.fonts.primary,
        },
        label: {
          fontFamily: theme.fonts.primary,
          textTransform: "uppercase",
          letterSpacing: 0.5,
        },
      },
      //#endregion Variant Styles

      //#region Size Styles
      size: {
        xs: { fontSize: 10, lineHeight: 14 },
        sm: { fontSize: 12, lineHeight: 16 },
        md: { fontSize: 14, lineHeight: 20 },
        lg: { fontSize: 16, lineHeight: 24 },
        xl: { fontSize: 20, lineHeight: 28 },
        xxl: { fontSize: 24, lineHeight: 32 },
      },
      //#endregion Size Styles

      //#region Weight Styles
      weight: {
        regular: { fontWeight: "400" },
        medium: { fontWeight: "500" },
        semiBold: { fontWeight: "600" },
        bold: { fontWeight: "700" },
      },
      //#endregion Weight Styles

      //#region Color Styles
      color: {
        primary: { color: theme.colors.centerChannelColor },
        secondary: { color: theme.colors.centerChannelColor, opacity: 0.72 },
        muted: { color: theme.colors.centerChannelColor, opacity: 0.56 },
        error: { color: theme.colors.errorText },
        link: { color: theme.colors.linkColor },
        inherit: {}, // Uses parent color
      },
      //#endregion Color Styles

      //#region Align Styles
      align: {
        left: { textAlign: "left" },
        center: { textAlign: "center" },
        right: { textAlign: "right" },
      },
      //#endregion Align Styles
    },
    compoundVariants: [
      // Headings are bold by default
      { variant: "heading", weight: "regular", styles: { fontWeight: "700" } },
      // Labels are semiBold by default
      { variant: "label", weight: "regular", styles: { fontWeight: "600" } },
      // Captions are smaller
      { variant: "caption", size: "md", styles: { fontSize: 12, lineHeight: 16 } },
    ],
  },
}));

//#endregion Styles
```

## Index Export

```typescript
// apps/v2/src/components/Text/index.ts

export { Text } from "./Text";
```

## Acceptance Criteria

- [ ] Supports 4 semantic variants: heading, body, caption, label
- [ ] Supports 6 size variants: xs (10px) to xxl (24px)
- [ ] Supports 4 weight variants: regular, medium, semiBold, bold
- [ ] Supports 6 color variants with theme integration
- [ ] Supports i18n via textKey prop
- [ ] Supports text truncation via numberOfLines
- [ ] Supports text alignment (left, center, right)
- [ ] Uses Unistyles variants (not conditional styles)
- [ ] All types use `I` prefix naming convention
- [ ] No `forwardRef` (React 19 ref prop)
- [ ] TypeScript strict mode passes
- [ ] No `any` types

## Testing

```typescript
// apps/v2/src/components/Text/Text.spec.tsx

import { render } from "@testing-library/react-native";
import { Text } from "./Text";

//#region Rendering Tests

describe("<Text />", () => {
  describe("rendering", () => {
    it("renders children", () => {
      const { getByText } = render(<Text>Hello World</Text>);
      expect(getByText("Hello World")).toBeTruthy();
    });

    it("renders with textKey (i18n)", () => {
      const { getByText } = render(<Text textKey="label.save" />);
      expect(getByText("Save")).toBeTruthy();
    });

    it("renders with textKey and params", () => {
      const { getByText } = render(
        <Text textKey="greeting.user" textParams={{ name: "John" }} />
      );
      expect(getByText("Hello, John")).toBeTruthy();
    });

    it("renders with testID", () => {
      const { getByTestId } = render(<Text testID="test-text">Content</Text>);
      expect(getByTestId("test-text")).toBeTruthy();
    });
  });

  //#endregion Rendering Tests

  //#region Variant Tests

  describe("variants", () => {
    it("renders heading variant", () => {
      const { getByText } = render(<Text variant="heading">Heading</Text>);
      expect(getByText("Heading")).toBeTruthy();
    });

    it("renders body variant (default)", () => {
      const { getByText } = render(<Text>Body text</Text>);
      expect(getByText("Body text")).toBeTruthy();
    });

    it("renders caption variant", () => {
      const { getByText } = render(<Text variant="caption">Caption</Text>);
      expect(getByText("Caption")).toBeTruthy();
    });

    it("renders label variant", () => {
      const { getByText } = render(<Text variant="label">Label</Text>);
      expect(getByText("Label")).toBeTruthy();
    });
  });

  //#endregion Variant Tests

  //#region Size Tests

  describe("sizes", () => {
    const sizes = ["xs", "sm", "md", "lg", "xl", "xxl"] as const;

    sizes.forEach((size) => {
      it(`renders ${size} size`, () => {
        const { getByText } = render(<Text size={size}>{size} text</Text>);
        expect(getByText(`${size} text`)).toBeTruthy();
      });
    });
  });

  //#endregion Size Tests

  //#region Weight Tests

  describe("weights", () => {
    const weights = ["regular", "medium", "semiBold", "bold"] as const;

    weights.forEach((weight) => {
      it(`renders ${weight} weight`, () => {
        const { getByText } = render(<Text weight={weight}>{weight}</Text>);
        expect(getByText(weight)).toBeTruthy();
      });
    });
  });

  //#endregion Weight Tests

  //#region Color Tests

  describe("colors", () => {
    const colors = ["primary", "secondary", "muted", "error", "link"] as const;

    colors.forEach((color) => {
      it(`renders ${color} color`, () => {
        const { getByText } = render(<Text color={color}>{color}</Text>);
        expect(getByText(color)).toBeTruthy();
      });
    });
  });

  //#endregion Color Tests

  //#region Truncation Tests

  describe("truncation", () => {
    it("applies numberOfLines", () => {
      const { getByText } = render(
        <Text numberOfLines={2}>
          This is a very long text that should be truncated after two lines
        </Text>
      );
      expect(getByText(/This is a very long/)).toBeTruthy();
    });

    it("applies ellipsizeMode", () => {
      const { getByText } = render(
        <Text numberOfLines={1} ellipsizeMode="middle">
          Long text
        </Text>
      );
      expect(getByText("Long text")).toBeTruthy();
    });
  });

  //#endregion Truncation Tests

  //#region Alignment Tests

  describe("alignment", () => {
    it("renders left aligned (default)", () => {
      const { getByText } = render(<Text>Left</Text>);
      expect(getByText("Left")).toBeTruthy();
    });

    it("renders center aligned", () => {
      const { getByText } = render(<Text align="center">Center</Text>);
      expect(getByText("Center")).toBeTruthy();
    });

    it("renders right aligned", () => {
      const { getByText } = render(<Text align="right">Right</Text>);
      expect(getByText("Right")).toBeTruthy();
    });
  });

  //#endregion Alignment Tests

  //#region Accessibility Tests

  describe("accessibility", () => {
    it("has text role", () => {
      const { getByRole } = render(<Text>Accessible</Text>);
      expect(getByRole("text")).toBeTruthy();
    });

    it("supports accessibilityLabel", () => {
      const { getByLabelText } = render(
        <Text accessibilityLabel="Custom label">Content</Text>
      );
      expect(getByLabelText("Custom label")).toBeTruthy();
    });
  });

  //#endregion Accessibility Tests
});
```

### Run Tests

```bash
pnpm --filter @retrievly/app test:unit -- Text
```

## Storybook

```typescript
// apps/v2/src/components/Text/Text.stories.tsx

import type { Meta, StoryObj } from "@storybook/react";
import { View } from "react-native";
import { Text } from "./Text";

const meta: Meta<typeof Text> = {
  title: "Components/Text",
  component: Text,
  argTypes: {
    variant: {
      control: "select",
      options: ["heading", "body", "caption", "label"],
    },
    size: {
      control: "select",
      options: ["xs", "sm", "md", "lg", "xl", "xxl"],
    },
    weight: {
      control: "select",
      options: ["regular", "medium", "semiBold", "bold"],
    },
    color: {
      control: "select",
      options: ["primary", "secondary", "muted", "error", "link"],
    },
    align: {
      control: "select",
      options: ["left", "center", "right"],
    },
  },
  decorators: [
    (Story) => (
      <View style={{ padding: 16 }}>
        <Story />
      </View>
    ),
  ],
};

export default meta;
type Story = StoryObj<typeof Text>;

//#region Variant Stories

export const Heading: Story = {
  args: {
    children: "Heading Text",
    variant: "heading",
    size: "xl",
  },
};

export const Body: Story = {
  args: {
    children: "Body text is used for regular content throughout the application.",
    variant: "body",
  },
};

export const Caption: Story = {
  args: {
    children: "Caption text for supplementary information",
    variant: "caption",
  },
};

export const Label: Story = {
  args: {
    children: "Form Label",
    variant: "label",
  },
};

//#endregion Variant Stories

//#region Typography Scale

export const TypographyScale: Story = {
  render: () => (
    <View style={{ gap: 8 }}>
      <Text size="xxl" weight="bold">XXL Bold (24px)</Text>
      <Text size="xl" weight="semiBold">XL SemiBold (20px)</Text>
      <Text size="lg">Large (16px)</Text>
      <Text size="md">Medium (14px) - Default</Text>
      <Text size="sm">Small (12px)</Text>
      <Text size="xs">Extra Small (10px)</Text>
    </View>
  ),
};

//#endregion Typography Scale

//#region Color Variants

export const ColorVariants: Story = {
  render: () => (
    <View style={{ gap: 8 }}>
      <Text color="primary">Primary - Main text color</Text>
      <Text color="secondary">Secondary - Less emphasis</Text>
      <Text color="muted">Muted - Minimal emphasis</Text>
      <Text color="error">Error - Error messages</Text>
      <Text color="link">Link - Clickable text</Text>
    </View>
  ),
};

//#endregion Color Variants

//#region Truncation

export const Truncation: Story = {
  args: {
    children: "This is a very long text that will be truncated after one line to demonstrate the numberOfLines prop working correctly with ellipsis.",
    numberOfLines: 1,
  },
};

//#endregion Truncation
```
