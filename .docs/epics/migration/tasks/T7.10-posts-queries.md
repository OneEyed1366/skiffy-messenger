# T7.10: Posts Queries

## Metadata

| Field        | Value                 |
| ------------ | --------------------- |
| **ID**       | T7.10                 |
| **Layer**    | L7 - State Management |
| **Status**   | pending               |
| **Priority** | high                  |
| **Estimate** | 4h                    |
| **Parallel** | true                  |
| **Assignee** | -                     |
| **Created**  | 2026-01-06            |
| **Updated**  | 2026-01-06            |

## Dependencies

| Task ID | Name         |
| ------- | ------------ |
| T7.01   | api-client   |
| T7.02   | query-client |
| T7.03   | query-keys   |

## Blocks

| Task ID | Name            |
| ------- | --------------- |
| T9.07   | usePost hook    |
| T10c.\* | Post components |

## Description

Create TanStack Query hooks for fetching posts from the REST API.

**Reference:** See [State Management Architecture](../../../architecture/state-management.md#query-hook-template) for patterns.

## Target Files

- `apps/v2/src/api/posts.ts` - API methods
- `apps/v2/src/queries/posts/usePostQuery.ts`
- `apps/v2/src/queries/posts/usePostsQuery.ts`
- `apps/v2/src/queries/posts/useInfinitePostsQuery.ts`
- `apps/v2/src/queries/posts/usePostThreadQuery.ts`
- `apps/v2/src/queries/posts/index.ts`

## Hooks to Implement

| Hook                    | Purpose               | Key Features        |
| ----------------------- | --------------------- | ------------------- |
| `usePostQuery`          | Single post by ID     | Auto-fetch, caching |
| `usePostsQuery`         | Posts in channel      | Pagination params   |
| `useInfinitePostsQuery` | Infinite scroll posts | getNextPageParam    |
| `usePostThreadQuery`    | Thread replies        | rootId param        |

## API Methods

```typescript
// api/posts.ts
export const postsApi = {
  getPost(postId: string): Promise<IPost>;
  getPosts(channelId: string, params?: IGetPostsParams): Promise<IPostsResponse>;
  getPostThread(postId: string): Promise<IPostsResponse>;
  searchPosts(teamId: string, params: ISearchParams): Promise<IPostsResponse>;
};
```

## Acceptance Criteria

- [ ] `usePostQuery(postId)` - fetches single post
- [ ] `usePostsQuery(channelId, params)` - fetches posts list
- [ ] `useInfinitePostsQuery(channelId)` - infinite scroll with before/after pagination
- [ ] `usePostThreadQuery(rootId)` - fetches thread replies
- [ ] All hooks use `queryKeys.posts.*` for cache keys
- [ ] Proper `enabled` conditions (e.g., `!!channelId`)
- [ ] TypeScript strict mode passes
