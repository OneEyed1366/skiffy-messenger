# T7.04: Store Setup Utility

## Metadata

| Field        | Value                 |
| ------------ | --------------------- |
| **ID**       | T7.04                 |
| **Layer**    | L7 - State Management |
| **Status**   | pending               |
| **Priority** | high                  |
| **Estimate** | 1h                    |
| **Parallel** | true                  |
| **Assignee** | -                     |
| **Created**  | 2026-01-06            |
| **Updated**  | 2026-01-06            |

## Dependencies

| Task ID | Name |
| ------- | ---- |
| -       | -    |

## Blocks

| Task ID | Name                    |
| ------- | ----------------------- |
| T7.30+  | All Zustand store tasks |

## Description

Create a factory function for creating Zustand stores with consistent middleware setup (devtools, persist).

**Reference:** See [State Management Architecture](../../../architecture/state-management.md#store-setup-utility) for full implementation.

## Target Files

- `apps/v2/src/stores/setup.ts`

## Key Features

```typescript
import { create, StateCreator } from "zustand";
import { persist, createJSONStorage, devtools } from "zustand/middleware";
import AsyncStorage from "@react-native-async-storage/async-storage";
import { Platform } from "react-native";

const storage =
  Platform.OS === "web"
    ? createJSONStorage(() => localStorage)
    : createJSONStorage(() => AsyncStorage);

type IStoreOptions = {
  name: string;
  persist?: boolean;
};

export function createStore<T>(
  initializer: StateCreator<T, [], []>,
  options: IStoreOptions,
) {
  if (options.persist) {
    return create<T>()(
      devtools(persist(initializer, { name: options.name, storage }), {
        name: options.name,
      }),
    );
  }
  return create<T>()(devtools(initializer, { name: options.name }));
}
```

## Acceptance Criteria

- [ ] `createStore<T>()` factory function
- [ ] Cross-platform storage (localStorage for web, AsyncStorage for native)
- [ ] DevTools integration for all stores
- [ ] Optional persistence middleware
- [ ] Consistent naming in DevTools
