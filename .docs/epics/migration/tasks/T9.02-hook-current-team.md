# T9.02: useCurrentTeam Hook

## Metadata

| Field        | Value            |
| ------------ | ---------------- |
| **ID**       | T9.02            |
| **Layer**    | L9 - State Hooks |
| **Status**   | pending          |
| **Priority** | high             |
| **Estimate** | 1h               |
| **Parallel** | true             |
| **Assignee** | -                |
| **Created**  | 2026-01-06       |
| **Updated**  | 2026-01-06       |

## Dependencies

| Task ID | Name        |
| ------- | ----------- |
| T7.04   | Store Setup |

## Blocks

| Task ID | Name                   |
| ------- | ---------------------- |
| T9.xx   | Layout components      |
| T10c.xx | Team-scoped components |

## Description

Create a hook to get the currently selected team from the teams store. Returns the team object and loading state.

## Source Analysis

- **Redux Selector**: `vendor/desktop/webapp/platform/client/src/selectors/entities/teams.ts` - `getCurrentTeam`

## Migration Target

- **Target File**: `apps/v2/src/hooks/useCurrentTeam/useCurrentTeam.ts`
- **Index Export**: `apps/v2/src/hooks/useCurrentTeam/index.ts`

## Implementation

```typescript
// apps/v2/src/hooks/useCurrentTeam/useCurrentTeam.ts

import { useTeamsStore } from "@/stores";
import type { ITeam } from "@/types";

//#region Types

type IUseCurrentTeamReturn = {
  team: ITeam | null;
  teamId: string | null;
  loading: boolean;
};

//#endregion

//#region Hook

export function useCurrentTeam(): IUseCurrentTeamReturn {
  const currentTeamId = useTeamsStore((state) => state.currentTeamId);
  const team = useTeamsStore((state) =>
    state.currentTeamId ? state.teams[state.currentTeamId] : null,
  );
  const loading = useTeamsStore((state) => state.isLoading);

  return { team, teamId: currentTeamId, loading };
}

//#endregion
```

## Index Export

```typescript
// apps/v2/src/hooks/useCurrentTeam/index.ts
export { useCurrentTeam } from "./useCurrentTeam";
```

## Acceptance Criteria

- [ ] Returns current team object or null
- [ ] Returns current team ID
- [ ] Returns loading state
- [ ] Re-renders only when relevant state changes
- [ ] TypeScript strict mode passes
- [ ] No `any` types

## Testing

```typescript
// apps/v2/src/hooks/useCurrentTeam/useCurrentTeam.spec.ts

import { renderHook } from "@testing-library/react-native";
import { useCurrentTeam } from "./useCurrentTeam";
import { useTeamsStore } from "@/stores";

jest.mock("@/stores");

describe("useCurrentTeam", () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  it("returns null when no team is selected", () => {
    (useTeamsStore as unknown as jest.Mock).mockImplementation((selector) =>
      selector({ currentTeamId: null, teams: {}, isLoading: false }),
    );

    const { result } = renderHook(() => useCurrentTeam());

    expect(result.current.team).toBeNull();
    expect(result.current.teamId).toBeNull();
    expect(result.current.loading).toBe(false);
  });

  it("returns current team when selected", () => {
    const mockTeam = { id: "team-1", name: "Test Team" };
    (useTeamsStore as unknown as jest.Mock).mockImplementation((selector) =>
      selector({
        currentTeamId: "team-1",
        teams: { "team-1": mockTeam },
        isLoading: false,
      }),
    );

    const { result } = renderHook(() => useCurrentTeam());

    expect(result.current.team).toEqual(mockTeam);
    expect(result.current.teamId).toBe("team-1");
  });

  it("returns loading state", () => {
    (useTeamsStore as unknown as jest.Mock).mockImplementation((selector) =>
      selector({ currentTeamId: null, teams: {}, isLoading: true }),
    );

    const { result } = renderHook(() => useCurrentTeam());

    expect(result.current.loading).toBe(true);
  });
});
```
