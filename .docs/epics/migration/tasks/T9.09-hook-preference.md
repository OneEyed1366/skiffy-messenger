# T9.09: usePreference Hook

## Metadata

| Field        | Value            |
| ------------ | ---------------- |
| **ID**       | T9.09            |
| **Layer**    | L9 - State Hooks |
| **Status**   | pending          |
| **Priority** | high             |
| **Estimate** | 1h               |
| **Parallel** | true             |
| **Assignee** | -                |
| **Created**  | 2026-01-06       |
| **Updated**  | 2026-01-06       |

## Dependencies

| Task ID | Name             |
| ------- | ---------------- |
| T7.06   | preferencesStore |

## Description

Create a hook to get and set user preferences by category and name. Returns a tuple of [value, setValue] for easy useState-like API.

## Source Analysis

- **Redux Selector**: `vendor/desktop/webapp/platform/client/src/selectors/entities/preferences.ts` - `get`, `getBool`

## Migration Target

- **Target File**: `apps/v2/src/hooks/usePreference/usePreference.ts`

## Implementation

```typescript
// apps/v2/src/hooks/usePreference/usePreference.ts

import { usePreferencesStore } from "@/stores";

//#region Types

type IUsePreferenceReturn = [
  value: string | undefined,
  setValue: (value: string) => Promise<void>,
];

//#endregion

//#region Hook

export function usePreference(
  category: string,
  name: string,
  defaultValue?: string,
): IUsePreferenceReturn {
  const key = `${category}--${name}`;

  const value = usePreferencesStore(
    (state) => state.preferences[key]?.value ?? defaultValue,
  );

  const savePreference = usePreferencesStore((state) => state.savePreference);

  const setValue = async (newValue: string) => {
    await savePreference({ category, name, value: newValue });
  };

  return [value, setValue];
}

//#endregion

//#region Specialized Hooks

export function useBooleanPreference(
  category: string,
  name: string,
  defaultValue = false,
): [boolean, (value: boolean) => Promise<void>] {
  const [value, setValue] = usePreference(category, name, String(defaultValue));

  return [value === "true", (newValue: boolean) => setValue(String(newValue))];
}

//#endregion
```

## Acceptance Criteria

- [ ] Returns preference value by category/name
- [ ] Provides setValue function to update
- [ ] Supports default value
- [ ] Provides useBooleanPreference variant
- [ ] TypeScript strict mode passes
