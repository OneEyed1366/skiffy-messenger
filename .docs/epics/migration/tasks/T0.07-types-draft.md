# T0.07: Draft Types

## Metadata

| Field        | Value      |
| ------------ | ---------- |
| **ID**       | T0.07      |
| **Layer**    | L0 - Types |
| **Status**   | pending    |
| **Priority** | high       |
| **Estimate** | 1h         |
| **Parallel** | true       |
| **Assignee** | -          |
| **Created**  | 2026-01-04 |
| **Updated**  | 2026-01-04 |

## Dependencies

| Task ID | Name       | Status  |
| ------- | ---------- | ------- |
| T0.03   | Post types | pending |

## Blocks

| Task ID | Name              |
| ------- | ----------------- |
| T8.19   | useDrafts         |
| T10a.09 | SidebarDraftsLink |
| T10e.08 | DraftsView        |

## Description

Migrate draft and scheduled post types from Mattermost.

## Source Files

- `vendor/desktop/webapp/platform/types/src/drafts.ts`
- `vendor/desktop/webapp/platform/types/src/schedule_post.ts`

## Target File

`apps/v2/src/types/draft.ts`

## Implementation

```typescript
// apps/v2/src/types/draft.ts

/**
 * Draft and scheduled post type definitions
 * Migrated from: vendor/desktop/webapp/platform/types/src/drafts.ts
 */

import type { IPostType, IPostMetadata, IPostPriorityMetadata } from "./post";

//#region Draft

export type IDraft = {
  create_at: number;
  update_at: number;
  delete_at: number;
  user_id: string;
  channel_id: string;
  root_id: string;
  message: string;
  type?: IPostType;
  props: Record<string, unknown>;
  file_ids?: string[];
  metadata?: IPostMetadata;
  priority?: IPostPriorityMetadata;
};

//#endregion

//#region Scheduled Post

export type IScheduledPostErrorCode =
  | "unknown_error"
  | "channel_archived"
  | "channel_not_found"
  | "user_missing_from_channel"
  | "no_channel_permission"
  | "no_channel_member"
  | "thread_deleted"
  | "unable_to_send";

export type IScheduledPost = Omit<IDraft, "delete_at"> & {
  id: string;
  scheduled_at: number;
  processed_at?: number;
  error_code?: IScheduledPostErrorCode;
};

//#endregion

//#region Scheduling Info

export type ISchedulingInfo = {
  scheduled_at?: number;
};

//#endregion

//#region Drafts State

export type IDraftsState = {
  drafts: Record<string, IDraft>;
  draftsByChannel: Record<string, string[]>;
  draftsByThread: Record<string, string[]>;
};

//#endregion

//#region Scheduled Posts State

export type IScheduledPostsState = {
  byId: Record<string, IScheduledPost | undefined>;
  byTeamId: Record<string, string[]>;
  errorsByTeamId: Record<string, string[]>;
  byChannelOrThreadId: Record<string, string[]>;
};

//#endregion
```

## Index Export

```typescript
// Add to apps/v2/src/types/index.ts

export type {
  IDraft,
  IScheduledPost,
  IScheduledPostErrorCode,
  ISchedulingInfo,
  IDraftsState,
  IScheduledPostsState,
} from "./draft";
```

## Acceptance Criteria

- [ ] Draft types migrated
- [ ] Scheduled post types migrated
- [ ] Proper imports from post types
- [ ] TypeScript compiles

## Testing

```bash
pnpm --filter @retrievly/app tsc --noEmit
```
